import{r as ve,t as be,a as L,R as o,L as T,B as A,i as ae,_ as z,b as ye,c as _e,d as G,e as Ee,f as we,g as xe,h as Se,j as Ne,k as Ae,l as Ce,m as Fe,n as $e,o as Be,p as Me,q as Le,s as Pe,u as j,v as De,w as U,x as P,y as C,z as Te,A as H,C as R,D as F,E as Ue,F as re,G as S,H as I,I as Ie,J as Re,K as ne,P as Ve,M as qe,N as je,O as Oe,Q as Qe,S as O,T as ke,U as ze,V as Ge,W as V,X as He,Y as Z,Z as se,$ as Ze,a0 as We,a1 as ie,a2 as Xe,a3 as Ye,a4 as Je,a5 as Ke,a6 as et,a7 as D,a8 as tt}from"./index.e116f490.js";import{_ as at,F as q,u as le,a as B}from"./FormElement.c218a28b.js";function rt(n,s){var u,m;ve(1,arguments);var c=be(n);if(isNaN(c.getTime()))throw new RangeError("Invalid time value");var d=String((u=s==null?void 0:s.format)!==null&&u!==void 0?u:"extended"),f=String((m=s==null?void 0:s.representation)!==null&&m!==void 0?m:"complete");if(d!=="extended"&&d!=="basic")throw new RangeError("format must be 'extended' or 'basic'");if(f!=="date"&&f!=="time"&&f!=="complete")throw new RangeError("representation must be 'date', 'time', or 'complete'");var p="",g="",v=d==="extended"?"-":"",y=d==="extended"?":":"";if(f!=="time"){var N=L(c.getDate(),2),b=L(c.getMonth()+1,2),_=L(c.getFullYear(),4);p="".concat(_).concat(v).concat(b).concat(v).concat(N)}if(f!=="date"){var E=c.getTimezoneOffset();if(E!==0){var w=Math.abs(E),h=L(Math.floor(w/60),2),l=L(w%60,2),i=E<0?"+":"-";g="".concat(i).concat(h,":").concat(l)}else g="Z";var t=L(c.getHours(),2),e=L(c.getMinutes(),2),r=L(c.getSeconds(),2),a=p===""?"":"T",x=[t,e,r].join(y);p="".concat(p).concat(a).concat(x).concat(g)}return p}const nt=()=>o.createElement("header",{className:"space-x-16"},o.createElement("span",{className:"space-x-8"},o.createElement(T,{to:"/admin/doors"},o.createElement(A,{content:"Luker"})),o.createElement(T,{to:"/admin/doors/new"},o.createElement(A,null,"Ny luke"))),o.createElement("span",{className:"space-x-8"},o.createElement(T,{to:"/admin/service_messages"},o.createElement(A,{content:"Driftsmeldinger"})),o.createElement(T,{to:"/admin/service_messages/new"},o.createElement(A,null,"Ny driftsmelding"))));var st=ae;function it(n,s,u){for(var m=-1,c=n.length;++m<c;){var d=n[m],f=s(d);if(f!=null&&(p===void 0?f===f&&!st(f):u(f,p)))var p=f,g=d}return g}var lt=it;function ot(n,s){return n<s}var ct=ot,ut=lt,mt=z,dt=ct;function ft(n,s){return n&&n.length?ut(n,mt(s),dt):void 0}var pt=ft,X=ye,ht=_e,gt=G,Y=X?X.isConcatSpreadable:void 0;function vt(n){return gt(n)||ht(n)||!!(Y&&n&&n[Y])}var bt=vt,yt=Ee,_t=bt;function oe(n,s,u,m,c){var d=-1,f=n.length;for(u||(u=_t),c||(c=[]);++d<f;){var p=n[d];s>0&&u(p)?s>1?oe(p,s-1,u,m,c):yt(c,p):m||(c[c.length]=p)}return c}var ce=oe;function Et(n,s){var u=n.length;for(n.sort(s);u--;)n[u]=n[u].value;return n}var wt=Et,J=ae;function xt(n,s){if(n!==s){var u=n!==void 0,m=n===null,c=n===n,d=J(n),f=s!==void 0,p=s===null,g=s===s,v=J(s);if(!p&&!v&&!d&&n>s||d&&f&&g&&!p&&!v||m&&f&&g||!u&&g||!c)return 1;if(!m&&!d&&!v&&n<s||v&&u&&c&&!m&&!d||p&&u&&c||!f&&c||!g)return-1}return 0}var St=xt,Nt=St;function At(n,s,u){for(var m=-1,c=n.criteria,d=s.criteria,f=c.length,p=u.length;++m<f;){var g=Nt(c[m],d[m]);if(g){if(m>=p)return g;var v=u[m];return g*(v=="desc"?-1:1)}}return n.index-s.index}var Ct=At,k=we,Ft=xe,$t=z,Bt=Se,Mt=wt,Lt=Ne,Pt=Ct,Dt=Ae,Tt=G;function Ut(n,s,u){s.length?s=k(s,function(d){return Tt(d)?function(f){return Ft(f,d.length===1?d[0]:d)}:d}):s=[Dt];var m=-1;s=k(s,Lt($t));var c=Bt(n,function(d,f,p){var g=k(s,function(v){return v(d)});return{criteria:g,index:++m,value:d}});return Mt(c,function(d,f){return Pt(d,f,u)})}var It=Ut,Rt=ce,Vt=It,qt=Ce,K=Fe,jt=qt(function(n,s){if(n==null)return[];var u=s.length;return u>1&&K(n,s[0],s[1])?s=[]:u>2&&K(s[0],s[1],s[2])&&(s=[s[0]]),Vt(n,Rt(s,1),[])}),Ot=jt,Qt=$e,kt=Be,zt="[object Number]";function Gt(n){return typeof n=="number"||kt(n)&&Qt(n)==zt}var Ht=Gt,Zt=at,Wt=Me;function Xt(n,s){return Zt(n,s,function(u,m){return Wt(n,m)})}var Yt=Xt,Jt=ce;function Kt(n){var s=n==null?0:n.length;return s?Jt(n,1):[]}var ea=Kt,ta=ea,aa=Le,ra=Pe;function na(n){return ra(aa(n,void 0,ta),n+"")}var sa=na,ia=Yt,la=sa,oa=la(function(n,s){return n==null?{}:ia(n,s)}),ca=oa;const ue=async()=>await C.get("/admin/challenges").then(({data:n})=>Te(n,"door")),Q=n=>j(["admin","challenges"],ue,{...n,staleTime:6e5}),me=n=>j(["admin","challenges"],ue,{staleTime:6e5,select:n?De(n):void 0}),ua=n=>C.get(`/admin/challenges/${H(n)}/posts`).then(({data:s})=>s),ma=n=>j(["admin","posts",n],()=>ua(n),{staleTime:3e5}),da=async n=>{if(n=ca(n,["markdown_content","files"]),!R(n))return await C.post("/admin/challenge_markdown",{challenge:n}).then(({data:s})=>s)},fa=(n,s)=>j(["admin","challenges","preview",n],()=>da(n),{staleTime:1/0,cacheTime:0,...s}),pa=()=>{const n=U();return P(["admin","challenges","create"],({challenge:s})=>C.post("/admin/challenges",{challenge:s}),{onSuccess:()=>{n.invalidateQueries("challenges"),n.invalidateQueries(["admin","challenges"])}})},ha=()=>{const n=U();return P(["admin","challenges","update"],({challenge:s})=>C.patch(`/admin/challenges/${H(s.door)}`,{challenge:s}),{onSuccess:()=>{n.invalidateQueries("challenges"),n.invalidateQueries(["admin","challenges"])}})},ga=()=>{const n=U();return P(["admin","challenges","destroy"],async({door:s})=>Ht(s)&&C.delete(`/admin/challenges/${H(s)}`),{onSuccess:()=>{n.invalidateQueries("challenges"),n.invalidateQueries(["admin","challenges"])}})},va=()=>{const n=U();return P(["admin","serviceMessages","create"],s=>C.post("/admin/service_messages",s),{onSuccess:()=>{n.invalidateQueries("serviceMessages")}})},ba=()=>{const n=U();return P(["admin","serviceMessages","update"],({uuid:s,...u})=>C.patch(`/admin/service_messages/${s}`,u),{onSuccess:()=>{n.invalidateQueries("serviceMessages")}})},ya=()=>{const n=U();return P(["admin","serviceMessages","delete"],({uuid:s})=>C.delete(`/admin/service_messages/${s}`),{onSuccess:()=>{n.invalidateQueries("serviceMessages")}})},_a=()=>P(["admin","activeStorage","createBlob"],({blob:n,config:s})=>C.post("/rails/active_storage/direct_uploads",{blob:n},s).then(({data:u})=>u)),Ea=()=>P(["admin","activeStorage","uploadFile"],({upload:{file:n,directUpload:s},config:u})=>C.put(s.url,n,{...u,headers:s.headers})),wa=({door:n,setDoor:s})=>{const{data:u}=Q();return u?o.createElement("label",{className:"block space-x-4"},o.createElement("select",{className:"form-select",defaultValue:n,onChange:m=>s(parseInt(m.target.value))},F(Ot(Ue(re(u)),"door"),({door:m,title:c},d)=>o.createElement("option",{key:d,value:m,label:`Luke ${m}: ${c}`},`Luke ${m}: ${c}`)))):null},xa=()=>{var N;const n=I(),{search:s}=Ie(),u=(N=s.match(/door=(?<door>\d+)/))==null?void 0:N.groups,{data:m}=Q(),c=S.exports.useMemo(()=>pt(re(m),"door"),[m]),{mutate:d,isLoading:f}=ga(),p=()=>{!window.confirm(`Er du sikker p\xE5 at du vil slette luke ${g} "${y==null?void 0:y.title}"?`)||d({door:g},{onSuccess:()=>{v(void 0),n.push("/admin/doors")}})},[g,v]=S.exports.useState(u&&parseInt(u.door));S.exports.useLayoutEffect(()=>{v(b=>b!=null?b:c==null?void 0:c.door)},[v,c]);const{data:y}=me(g!=null?g:c==null?void 0:c.door);return Re(g)?null:o.createElement("div",{className:"space-y-door-elements"},o.createElement(ne,{challenge:y,withoutInput:!0,preamble:o.createElement("div",{className:"w-full flex justify-between mb-8"},o.createElement(wa,{door:g,setDoor:v}),o.createElement("div",{className:"space-x-8"},o.createElement(T,{to:`/admin/doors/${g}/edit`},o.createElement(A,{disabled:f},"Rediger luke")),o.createElement(A,{disabled:f,onClick:p},"Slett luke")))}),o.createElement(Ve,{door:g,usePosts:ma,withoutInput:!0}))};var Sa=S.exports.memo(xa),Na="Expected a function";function Aa(n){if(typeof n!="function")throw new TypeError(Na);return function(){var s=arguments;switch(s.length){case 0:return!n.call(this);case 1:return!n.call(this,s[0]);case 2:return!n.call(this,s[0],s[1]);case 3:return!n.call(this,s[0],s[1],s[2])}return!n.apply(this,s)}}var Ca=Aa,Fa=qe,$a=je,Ba=z,Ma=G,La=Ca;function Pa(n,s){var u=Ma(n)?Fa:$a;return u(n,La(Ba(s)))}var de=Pa;const fe=()=>{const{data:n}=Q();return de(Oe(1,25),s=>Qe(n,s))};var pe={exports:{}};(function(n,s){(function(u){n.exports=u()})(function(u){var m=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function c(l,i){var t=l[0],e=l[1],r=l[2],a=l[3];t+=(e&r|~e&a)+i[0]-680876936|0,t=(t<<7|t>>>25)+e|0,a+=(t&e|~t&r)+i[1]-389564586|0,a=(a<<12|a>>>20)+t|0,r+=(a&t|~a&e)+i[2]+606105819|0,r=(r<<17|r>>>15)+a|0,e+=(r&a|~r&t)+i[3]-1044525330|0,e=(e<<22|e>>>10)+r|0,t+=(e&r|~e&a)+i[4]-176418897|0,t=(t<<7|t>>>25)+e|0,a+=(t&e|~t&r)+i[5]+1200080426|0,a=(a<<12|a>>>20)+t|0,r+=(a&t|~a&e)+i[6]-1473231341|0,r=(r<<17|r>>>15)+a|0,e+=(r&a|~r&t)+i[7]-45705983|0,e=(e<<22|e>>>10)+r|0,t+=(e&r|~e&a)+i[8]+1770035416|0,t=(t<<7|t>>>25)+e|0,a+=(t&e|~t&r)+i[9]-1958414417|0,a=(a<<12|a>>>20)+t|0,r+=(a&t|~a&e)+i[10]-42063|0,r=(r<<17|r>>>15)+a|0,e+=(r&a|~r&t)+i[11]-1990404162|0,e=(e<<22|e>>>10)+r|0,t+=(e&r|~e&a)+i[12]+1804603682|0,t=(t<<7|t>>>25)+e|0,a+=(t&e|~t&r)+i[13]-40341101|0,a=(a<<12|a>>>20)+t|0,r+=(a&t|~a&e)+i[14]-1502002290|0,r=(r<<17|r>>>15)+a|0,e+=(r&a|~r&t)+i[15]+1236535329|0,e=(e<<22|e>>>10)+r|0,t+=(e&a|r&~a)+i[1]-165796510|0,t=(t<<5|t>>>27)+e|0,a+=(t&r|e&~r)+i[6]-1069501632|0,a=(a<<9|a>>>23)+t|0,r+=(a&e|t&~e)+i[11]+643717713|0,r=(r<<14|r>>>18)+a|0,e+=(r&t|a&~t)+i[0]-373897302|0,e=(e<<20|e>>>12)+r|0,t+=(e&a|r&~a)+i[5]-701558691|0,t=(t<<5|t>>>27)+e|0,a+=(t&r|e&~r)+i[10]+38016083|0,a=(a<<9|a>>>23)+t|0,r+=(a&e|t&~e)+i[15]-660478335|0,r=(r<<14|r>>>18)+a|0,e+=(r&t|a&~t)+i[4]-405537848|0,e=(e<<20|e>>>12)+r|0,t+=(e&a|r&~a)+i[9]+568446438|0,t=(t<<5|t>>>27)+e|0,a+=(t&r|e&~r)+i[14]-1019803690|0,a=(a<<9|a>>>23)+t|0,r+=(a&e|t&~e)+i[3]-187363961|0,r=(r<<14|r>>>18)+a|0,e+=(r&t|a&~t)+i[8]+1163531501|0,e=(e<<20|e>>>12)+r|0,t+=(e&a|r&~a)+i[13]-1444681467|0,t=(t<<5|t>>>27)+e|0,a+=(t&r|e&~r)+i[2]-51403784|0,a=(a<<9|a>>>23)+t|0,r+=(a&e|t&~e)+i[7]+1735328473|0,r=(r<<14|r>>>18)+a|0,e+=(r&t|a&~t)+i[12]-1926607734|0,e=(e<<20|e>>>12)+r|0,t+=(e^r^a)+i[5]-378558|0,t=(t<<4|t>>>28)+e|0,a+=(t^e^r)+i[8]-2022574463|0,a=(a<<11|a>>>21)+t|0,r+=(a^t^e)+i[11]+1839030562|0,r=(r<<16|r>>>16)+a|0,e+=(r^a^t)+i[14]-35309556|0,e=(e<<23|e>>>9)+r|0,t+=(e^r^a)+i[1]-1530992060|0,t=(t<<4|t>>>28)+e|0,a+=(t^e^r)+i[4]+1272893353|0,a=(a<<11|a>>>21)+t|0,r+=(a^t^e)+i[7]-155497632|0,r=(r<<16|r>>>16)+a|0,e+=(r^a^t)+i[10]-1094730640|0,e=(e<<23|e>>>9)+r|0,t+=(e^r^a)+i[13]+681279174|0,t=(t<<4|t>>>28)+e|0,a+=(t^e^r)+i[0]-358537222|0,a=(a<<11|a>>>21)+t|0,r+=(a^t^e)+i[3]-722521979|0,r=(r<<16|r>>>16)+a|0,e+=(r^a^t)+i[6]+76029189|0,e=(e<<23|e>>>9)+r|0,t+=(e^r^a)+i[9]-640364487|0,t=(t<<4|t>>>28)+e|0,a+=(t^e^r)+i[12]-421815835|0,a=(a<<11|a>>>21)+t|0,r+=(a^t^e)+i[15]+530742520|0,r=(r<<16|r>>>16)+a|0,e+=(r^a^t)+i[2]-995338651|0,e=(e<<23|e>>>9)+r|0,t+=(r^(e|~a))+i[0]-198630844|0,t=(t<<6|t>>>26)+e|0,a+=(e^(t|~r))+i[7]+1126891415|0,a=(a<<10|a>>>22)+t|0,r+=(t^(a|~e))+i[14]-1416354905|0,r=(r<<15|r>>>17)+a|0,e+=(a^(r|~t))+i[5]-57434055|0,e=(e<<21|e>>>11)+r|0,t+=(r^(e|~a))+i[12]+1700485571|0,t=(t<<6|t>>>26)+e|0,a+=(e^(t|~r))+i[3]-1894986606|0,a=(a<<10|a>>>22)+t|0,r+=(t^(a|~e))+i[10]-1051523|0,r=(r<<15|r>>>17)+a|0,e+=(a^(r|~t))+i[1]-2054922799|0,e=(e<<21|e>>>11)+r|0,t+=(r^(e|~a))+i[8]+1873313359|0,t=(t<<6|t>>>26)+e|0,a+=(e^(t|~r))+i[15]-30611744|0,a=(a<<10|a>>>22)+t|0,r+=(t^(a|~e))+i[6]-1560198380|0,r=(r<<15|r>>>17)+a|0,e+=(a^(r|~t))+i[13]+1309151649|0,e=(e<<21|e>>>11)+r|0,t+=(r^(e|~a))+i[4]-145523070|0,t=(t<<6|t>>>26)+e|0,a+=(e^(t|~r))+i[11]-1120210379|0,a=(a<<10|a>>>22)+t|0,r+=(t^(a|~e))+i[2]+718787259|0,r=(r<<15|r>>>17)+a|0,e+=(a^(r|~t))+i[9]-343485551|0,e=(e<<21|e>>>11)+r|0,l[0]=t+l[0]|0,l[1]=e+l[1]|0,l[2]=r+l[2]|0,l[3]=a+l[3]|0}function d(l){var i=[],t;for(t=0;t<64;t+=4)i[t>>2]=l.charCodeAt(t)+(l.charCodeAt(t+1)<<8)+(l.charCodeAt(t+2)<<16)+(l.charCodeAt(t+3)<<24);return i}function f(l){var i=[],t;for(t=0;t<64;t+=4)i[t>>2]=l[t]+(l[t+1]<<8)+(l[t+2]<<16)+(l[t+3]<<24);return i}function p(l){var i=l.length,t=[1732584193,-271733879,-1732584194,271733878],e,r,a,x,$,M;for(e=64;e<=i;e+=64)c(t,d(l.substring(e-64,e)));for(l=l.substring(e-64),r=l.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<r;e+=1)a[e>>2]|=l.charCodeAt(e)<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(c(t,a),e=0;e<16;e+=1)a[e]=0;return x=i*8,x=x.toString(16).match(/(.*?)(.{0,8})$/),$=parseInt(x[2],16),M=parseInt(x[1],16)||0,a[14]=$,a[15]=M,c(t,a),t}function g(l){var i=l.length,t=[1732584193,-271733879,-1732584194,271733878],e,r,a,x,$,M;for(e=64;e<=i;e+=64)c(t,f(l.subarray(e-64,e)));for(l=e-64<i?l.subarray(e-64):new Uint8Array(0),r=l.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<r;e+=1)a[e>>2]|=l[e]<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(c(t,a),e=0;e<16;e+=1)a[e]=0;return x=i*8,x=x.toString(16).match(/(.*?)(.{0,8})$/),$=parseInt(x[2],16),M=parseInt(x[1],16)||0,a[14]=$,a[15]=M,c(t,a),t}function v(l){var i="",t;for(t=0;t<4;t+=1)i+=m[l>>t*8+4&15]+m[l>>t*8&15];return i}function y(l){var i;for(i=0;i<l.length;i+=1)l[i]=v(l[i]);return l.join("")}y(p("hello")),typeof ArrayBuffer!="undefined"&&!ArrayBuffer.prototype.slice&&function(){function l(i,t){return i=i|0||0,i<0?Math.max(i+t,0):Math.min(i,t)}ArrayBuffer.prototype.slice=function(i,t){var e=this.byteLength,r=l(i,e),a=e,x,$,M,W;return t!==u&&(a=l(t,e)),r>a?new ArrayBuffer(0):(x=a-r,$=new ArrayBuffer(x),M=new Uint8Array($),W=new Uint8Array(this,r,x),M.set(W),$)}}();function N(l){return/[\u0080-\uFFFF]/.test(l)&&(l=unescape(encodeURIComponent(l))),l}function b(l,i){var t=l.length,e=new ArrayBuffer(t),r=new Uint8Array(e),a;for(a=0;a<t;a+=1)r[a]=l.charCodeAt(a);return i?r:e}function _(l){return String.fromCharCode.apply(null,new Uint8Array(l))}function E(l,i,t){var e=new Uint8Array(l.byteLength+i.byteLength);return e.set(new Uint8Array(l)),e.set(new Uint8Array(i),l.byteLength),t?e:e.buffer}function w(l){var i=[],t=l.length,e;for(e=0;e<t-1;e+=2)i.push(parseInt(l.substr(e,2),16));return String.fromCharCode.apply(String,i)}function h(){this.reset()}return h.prototype.append=function(l){return this.appendBinary(N(l)),this},h.prototype.appendBinary=function(l){this._buff+=l,this._length+=l.length;var i=this._buff.length,t;for(t=64;t<=i;t+=64)c(this._hash,d(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},h.prototype.end=function(l){var i=this._buff,t=i.length,e,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a;for(e=0;e<t;e+=1)r[e>>2]|=i.charCodeAt(e)<<(e%4<<3);return this._finish(r,t),a=y(this._hash),l&&(a=w(a)),this.reset(),a},h.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},h.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},h.prototype.setState=function(l){return this._buff=l.buff,this._length=l.length,this._hash=l.hash,this},h.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},h.prototype._finish=function(l,i){var t=i,e,r,a;if(l[t>>2]|=128<<(t%4<<3),t>55)for(c(this._hash,l),t=0;t<16;t+=1)l[t]=0;e=this._length*8,e=e.toString(16).match(/(.*?)(.{0,8})$/),r=parseInt(e[2],16),a=parseInt(e[1],16)||0,l[14]=r,l[15]=a,c(this._hash,l)},h.hash=function(l,i){return h.hashBinary(N(l),i)},h.hashBinary=function(l,i){var t=p(l),e=y(t);return i?w(e):e},h.ArrayBuffer=function(){this.reset()},h.ArrayBuffer.prototype.append=function(l){var i=E(this._buff.buffer,l,!0),t=i.length,e;for(this._length+=l.byteLength,e=64;e<=t;e+=64)c(this._hash,f(i.subarray(e-64,e)));return this._buff=e-64<t?new Uint8Array(i.buffer.slice(e-64)):new Uint8Array(0),this},h.ArrayBuffer.prototype.end=function(l){var i=this._buff,t=i.length,e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r,a;for(r=0;r<t;r+=1)e[r>>2]|=i[r]<<(r%4<<3);return this._finish(e,t),a=y(this._hash),l&&(a=w(a)),this.reset(),a},h.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},h.ArrayBuffer.prototype.getState=function(){var l=h.prototype.getState.call(this);return l.buff=_(l.buff),l},h.ArrayBuffer.prototype.setState=function(l){return l.buff=b(l.buff,!0),h.prototype.setState.call(this,l)},h.ArrayBuffer.prototype.destroy=h.prototype.destroy,h.ArrayBuffer.prototype._finish=h.prototype._finish,h.ArrayBuffer.hash=function(l,i){var t=g(new Uint8Array(l)),e=y(t);return i?w(e):e},h})})(pe);var Da=pe.exports;const Ta=()=>{const n=S.exports.useRef(!0),s=S.exports.useCallback(()=>n.current,[]);return S.exports.useEffect(()=>()=>void(n.current=!1),[]),s};let ee=0;const Ua=({challenge:n,register:s,setValue:u,className:m})=>{s("files");const{mutateAsync:c}=_a(),{mutateAsync:d}=Ea(),[f,p]=S.exports.useState(F(n.files,_=>({..._,fileId:ee++})));S.exports.useEffect(()=>{u("files",F(f,"signed_id"))},[u,f]);const[g,v]=S.exports.useState({}),y=Ta(),N=async _=>{await Promise.all(F(_,async E=>{const w=ee++;v(e=>({...e,[w]:{progress:0}}));const h={filename:E.name,content_type:E.type,byte_size:E.size,checksum:btoa(Da.ArrayBuffer.hash(await E.arrayBuffer(),!0))},{signed_id:l,direct_upload:i}=await c({blob:h});!y()||(p(e=>[...e,{signed_id:l,filename:E.name,fileId:w}]),await d({upload:{file:E,directUpload:i},config:{onUploadProgress:e=>{!y()||v(r=>({...r,[w]:{progress:e.loaded/e.total}}))}}}),!y())||v(e=>({...e,[w]:{progress:1}}))}))},b=S.exports.useRef(null);return o.createElement("div",{className:O("space-y-2",m)},o.createElement(q,{label:"Filer",note:"husk \xE5 dobbeltsjekke riktig filnavn i markdown"},o.createElement("input",{ref:b,className:"hidden",type:"file",multiple:!0,onChange:({target:{files:_}})=>_&&N(_)}),o.createElement(A,{className:"block form-input",type:"button",underline:!1,content:"Velg filer...",onClick:()=>{var _;return(_=b.current)==null?void 0:_.click()}})),o.createElement("div",{className:"grid grid-cols-4 gap-2"},F(f,({filename:_,signed_id:E,fileId:w})=>{var l,i;const h=(i=(l=g[w])==null?void 0:l.progress)!=null?i:1;return o.createElement("span",{key:E,className:"relative overflow-hidden p-1 border-2 rounded-md border-lightbulb-yellow text-center"},h<1&&o.createElement("div",{style:{width:`calc(${h*100}% + ${h*.5}rem)`},className:"absolute top-[-.25rem] left-[-.25rem] h-[calc(100%+.5rem)] bg-blue-400 bg-opacity-20"}),o.createElement("span",{className:"inline-block w-[calc(100%-1.5rem)] line-clamp-1"},_),o.createElement(ke,{className:"absolute top-0 right-2 h-full w-3 cursor-pointer",onClick:()=>p(t=>de(t,{signed_id:E}))}))})))},Ia=({challenge:n,newForm:s=!1,submit:u})=>{var t,e;const[m,c]=S.exports.useState(!1),{register:d,handleSubmit:f,setValue:p,getValues:g,watch:v,formState:{dirtyFields:{door:y}}}=le({defaultValues:{...n,files:F(n.files,"signed_id")}}),[N,b]=S.exports.useState(),{data:_}=fa(N,{enabled:m}),E=()=>{c(r=>(b(r?void 0:g()),!r))},w=fe(),h=v("door"),l=(t=n.active_from)!=null?t:ze(y?h:n.door),i=(e=n.active_to)!=null?e:Ge();return o.createElement("div",{className:"space-y-8"},o.createElement("form",{className:"space-y-4",onSubmit:f(r=>u({...r,door:y?h:n.door}))},o.createElement("div",{className:"space-x-4"},o.createElement(A,{type:"submit"},"Lagre"),o.createElement(A,{type:"button",className:"uppercase",onClick:E},m?"Rediger":"Forh\xE5ndsvisning")),o.createElement("div",{className:O("grid grid-cols-3 gap-4",m&&"hidden")},s&&o.createElement(q,{label:"Luke",className:"col-span-3"},o.createElement("select",{className:"block form-select",defaultValue:w[0],...d("door",{required:!0})},F(w,r=>o.createElement("option",{key:r,value:r,label:Z(r)})))),o.createElement(B,{label:"Tittel",type:"text",defaultValue:n.title,...d("title",{required:!0})}),o.createElement(B,{label:"Forfatter",type:"text",defaultValue:n.author,...d("author",{required:!0})}),o.createElement(B,{label:"Svar",note:"omringende whitespace blir ignorert",type:"text",defaultValue:n.answer,...d("answer",{required:!0})}),o.createElement(B,{label:"Aktiv fra",disabled:!0,type:"datetime-local",value:V(l)}),o.createElement(B,{label:"Aktiv til",disabled:!0,type:"datetime-local",value:V(i)}),o.createElement(Ua,{challenge:n,register:d,setValue:p,className:"col-span-3"}),o.createElement(q,{label:"Innhold",note:"tittel-elementet blir erstattet med tittel fra over",className:"col-span-3"},o.createElement(He,{className:"block w-full form-textarea",rows:5,defaultValue:n.markdown_content,...d("markdown_content",{required:!0})})))),m&&N&&_&&o.createElement(ne,{withoutInput:!0,challenge:{...N,content:_.html}}))};var he=S.exports.memo(Ia);const Ra=()=>{const{door:n}=se(),s=parseInt(n),u=I(),{data:m,isLoading:c}=me(s),{mutate:d}=ha(),f=p=>{d({challenge:p},{onSuccess:()=>u.push(`/admin/doors?door=${p.door}`)})};return S.exports.useEffect(()=>{!c&&!m&&u.push("/admin/doors/new")},[c,m,u]),c||!m?null:o.createElement("div",{className:"space-y-8"},o.createElement("div",{className:"text-center"},o.createElement("span",{className:"text-4xl font-semibold"},"Luke ",s)),o.createElement(he,{challenge:m,submit:f}))};var Va=Ze,qa=Z,ja=/^\s+/,Oa=Va.parseInt;function Qa(n,s,u){return u||s==null?s=0:s&&(s=+s),Oa(qa(n).replace(ja,""),s||0)}var te=Qa;const ka=({serviceMessage:n,newForm:s=!1,submit:u})=>{var p,g,v,y,N;const{register:m,handleSubmit:c,setValue:d}=le({defaultValues:{...n,...!s&&{resolved_at:V((p=n.resolved_at)!=null?p:rt(new Date))}}}),{data:f}=Q({select:b=>F(We(b),te)});return o.createElement("div",{className:"space-y-8"},o.createElement("form",{className:"space-y-4",onSubmit:c(u)},o.createElement("div",{className:"space-x-4"},o.createElement(A,{type:"submit"},"Lagre")),o.createElement("div",{className:O("grid grid-cols-3 gap-4")},o.createElement(B,{label:"Innhold",type:"text",labelClassName:"col-span-3",className:"w-full",defaultValue:n.content,...m("content",{required:!0})}),!s&&o.createElement(B,{label:"L\xF8sning",type:"text",labelClassName:"col-span-3",className:"w-full",defaultValue:(g=n.resolution_content)!=null?g:"",...m("resolution_content",{setValueAs:b=>R(b)?null:b})}),o.createElement(q,{label:"Luke",className:"col-span-3",defaultValue:(v=n.resolution_content)!=null?v:""},o.createElement("select",{className:"block form-select",defaultValue:(y=n.door)!=null?y:void 0,...m("door",{setValueAs:b=>R(b)?void 0:te(b)})},o.createElement("option",{label:"-",value:""}),F(f,b=>o.createElement("option",{key:b,label:Z(b),value:b})))),!s&&o.createElement(o.Fragment,null,o.createElement(B,{label:"Opprettet",type:"datetime-local",value:V((N=n.created_at)!=null?N:""),disabled:!0}),o.createElement("div",null,o.createElement(B,{label:"L\xF8sningstidspunkt",type:"datetime-local",...m("resolved_at")}),o.createElement(A,{type:"button",className:"!text-xs",onClick:()=>d("resolved_at",null),content:"Nullstill"}))))))};var ge=S.exports.memo(ka);const za=()=>{const{uuid:n}=se(),s=I(),{data:u,isLoading:m}=ie({select:f=>Xe(f,{uuid:n})}),{mutate:c}=ba(),d=f=>{c({uuid:n,service_message:f},{onSuccess:()=>s.push("/admin/service_messages")})};return S.exports.useEffect(()=>{!m&&!u&&s.push("/admin/service_messages/new")},[m,u,s]),m||!u?null:o.createElement("div",{className:"space-y-8"},o.createElement("div",{className:"text-center"},o.createElement("span",{className:"text-4xl font-semibold"},"Endre driftsmelding")),o.createElement(ge,{serviceMessage:u,submit:d}))},Ga=()=>{const n=I(),{mutate:s}=pa(),u=c=>{s({challenge:c},{onSuccess:()=>n.push(`/admin/doors?door=${c.door}`)})},m=fe();return R(m)?o.createElement("div",{className:"text-center"},o.createElement("span",{className:"text-4xl font-semibold"},"Ingen ledige luker!")):o.createElement("div",{className:"space-y-8"},o.createElement("div",{className:"text-center"},o.createElement("span",{className:"text-4xl font-semibold"},"Ny luke")),o.createElement(he,{newForm:!0,challenge:{door:m[0],title:"",author:"",answer:"",markdown_content:"",files:[]},submit:u}))},Ha=()=>{const n=I(),{mutate:s}=va(),u=m=>{s({service_message:m},{onSuccess:()=>n.push("/admin/service_messages")})};return o.createElement("div",{className:"space-y-8"},o.createElement("div",{className:"text-center"},o.createElement("span",{className:"text-4xl font-semibold"},"Ny driftsmelding")),o.createElement(ge,{newForm:!0,serviceMessage:{content:"",resolution_content:null,resolved_at:null},submit:u}))},Za=()=>{const{data:n,isLoading:s}=ie(),{mutate:u}=ya(),m=c=>{!window.confirm("Sikker p\xE5 at du vil slette driftsmelding?")||u({uuid:c})};return s?null:o.createElement(o.Fragment,null,o.createElement("div",{className:"text-center"},o.createElement("h1",{className:"text-4xl font-semibold"},"Driftsmeldinger")),o.createElement("div",{className:"grid grid-cols-1 gap-6 justify-items-center"},R(n)?o.createElement("div",null,"\u{1F384} Ingen driftsmeldinger. Livet er herlig! \u{1F384}"):F(n,c=>{const d=c.resolved_at?"border-lightbulb-yellow border-opacity-70 text-gray-700 text-opacity-70":"border-red-700 border-opacity-70";return o.createElement("div",{key:c.uuid,className:"w-full max-w-[40rem]"},o.createElement("div",{className:"m-2 space-x-4"},o.createElement(T,{to:`/admin/service_messages/${c.uuid}/edit`},o.createElement(A,{content:"Rediger"})),o.createElement(A,{content:"Slett",onClick:()=>m(c.uuid)})),o.createElement(Ye,{className:O("border-2 p-4 rounded-md w-full",d),serviceMessage:c}))})))},Ya=()=>{const n=I(),{data:s,isLoading:u}=Je();return!u&&(!s||!s.is_admin)&&n.push("/"),o.createElement(Ke,{className:"py-12 px-8 md:px-12 mx-4 md:mx-8 bg-gray-100 text-gray-700 rounded-md space-y-8"},o.createElement(nt,null),o.createElement(et,null,o.createElement(D,{exact:!0,path:"/admin/doors",component:Sa}),o.createElement(D,{path:"/admin/doors/new",component:Ga}),o.createElement(D,{path:"/admin/doors/:door/edit",component:Ra}),o.createElement(D,{exact:!0,path:"/admin/service_messages",component:Za}),o.createElement(D,{path:"/admin/service_messages/new",component:Ha}),o.createElement(D,{path:"/admin/service_messages/:uuid/edit",component:za}),o.createElement(tt,{to:"/admin/doors"})))};export{Ya as default};
